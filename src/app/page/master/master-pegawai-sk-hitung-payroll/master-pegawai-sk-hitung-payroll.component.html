<div class="ui-fluid">
    <div class="ui-g">
        <div class="ui-g-12">
            <div class="card card-w-title">
                <p-confirmDialog header="Confirmation" icon="fa fa-question-circle" width="425"></p-confirmDialog>
                <h1>{{'frmPegawaiSkHitungPayroll_title' | translate | splitCharT }}</h1>
                <div class="ui-g form-group">
                    <div class="ui-g-12">
                        <div class="ui-g-12">
                            <form [formGroup]="form" (ngSubmit)="onSubmit()">
                                <div class="ui-g-12">
                                    <p-fieldset legend="">
                                        <div class="ui-g form-group">
                                            <div class="ui-g-12 ui-md-4" style="margin-top: 8px;">
                                                <div class="ui-g-12 ui-md-9">
                                                    <label>{{'frmPegawaiSkHitungPayroll_nama'| translate | splitCharT}}
                                                        <span style="color: red;font-weight: bolder;">*</span>
                                                        <span *ngIf="!form.get('namaSK').valid && form.get('namaSK').touched" style="color: red;font-weight: bolder;"> {{'frmPegawaiSkHitungPayroll_required'| translate | splitCharT}}</span>
                                                    </label>
                                                    <p-dropdown formControlName="namaSK" (onChange)="ambilSK($event)" class="ui-inputwrapper-filled" [options]="namaSK" [autoWidth]="false"></p-dropdown>
                                                </div>
                                                <div class="ui-g-12 ui-md-3">
                                                    <br>
                                                    <button pButton type="button" (click)="getKelompokTransaksi()" label="{{'frmPegawaiSkHitungPayroll_btnBuat'| translate | splitCharT }}"></button>
                                                </div>

                                                <div class="ui-g-12 ui-md-12" hidden>
                                                    <label>{{'frmPegawaiSkHitungPayroll_nomor'| translate | splitCharT}}
                                                    </label>
                                                    <input id="input" type="text" pInputText formControlName="noSK" disabled />
                                                </div><div class="ui-g-12 ui-md-12">
                                                    <label>{{'frmPegawaiSkHitungPayroll_noSKIntern'| translate | splitCharT}}
                                                    </label>
                                                    <input id="input" type="text" pInputText formControlName="noSKIntern" disabled />
                                                </div>

                                            </div>
                                            
                                            <!-- <div class="ui-g-12 ui-md-3" style="margin-top: 9px; margin-left: 40px;">
                                                <div class="ui-g-12 ui-md-8" hidden>
                                                    <label>{{'frmPegawaiSkHitungPayroll_nomor'| translate | splitCharT}}
                                                    </label>
                                                    <input id="input" type="text" pInputText formControlName="noSK" disabled />
                                                </div><div class="ui-g-12 ui-md-8">
                                                    <label>{{'frmPegawaiSkHitungPayroll_noSKIntern'| translate | splitCharT}}
                                                    </label>
                                                    <input id="input" type="text" pInputText formControlName="noSKIntern" disabled />
                                                </div>
                                            </div> -->
                                            <div class="ui-g-12 ui-md-6" style="margin-top: 9px; margin-left: 40px;">
                                                <!-- <div class="ui-g-12 ui-md-4" style="margin-top: 4px; margin-left: -70px;"> -->
                                                    <div class="ui-g form-group">
                                                        <div class="ui-g-12 ui-md-12">
                                                            <label>{{'frmPegawaiSkHitungPayroll_tanggalBerlakuAwal'| translate | splitCharT}}
                                                            </label>
                                                        </div>
                                                        <div class="ui-g-12 ui-md-5">
                                                            <app-calender dateFormat="dd M yy" dateFormat="dd M yy" formControlName="tglBerlakuSkDari" [monthNavigator]="true" [yearNavigator]="true"
                                                            yearRange="2000:2030" [showIcon]="true"></app-calender>
                                                        </div>
                                                        <div>
                                                            <label>-</label>
                                                        </div>
                                                        <div class="ui-g-12 ui-md-5">
                                                            <app-calender dateFormat="dd M yy" formControlName="tglBerlakuSkSampai" [monthNavigator]="true" [yearNavigator]="true" yearRange="2000:2030"
                                                            [showIcon]="true"></app-calender>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </p-fieldset>
                                    </div>
                                    <div class="ui-g-12">
                                        <p-fieldset legend="">
                                            <div class="ui-g form-group">
                                                <div class="ui-g-12 ui-md-3">
                                                    <div class="ui-g-12 ui-md-12">
                                                        <label>
                                                            {{'frmPegawaiSkHitungPayroll_masaKerja'| translate | splitCharT }}
                                                            <span style="color: red;font-weight: bolder;">*</span>
                                                            <span *ngIf="!form.get('masaKerja').valid && form.get('masaKerja').touched" style="color: red;font-weight: bolder;"> {{'frmPegawaiSkHitungPayroll_required'| translate | splitCharT }}</span>
                                                        </label>
                                                        <p-multiSelect [options]="masaKerja" formControlName="masaKerja" [(ngModel)]="selectedRange" multiple="multiple" checkbox="checkbox"
                                                        filterBy="label" optionLabel="label">
                                                    </p-multiSelect>
                                                </div>
                                            </div>
                                        </div>
                                    </p-fieldset>
                                </div>
                                <div class="ui-g-12">
                                    <p-fieldset legend="">
                                        <div class="ui-g-12 ui-md-3">
                                            <div class="ui-g-12 ui-md-12">
                                                <label>
                                                    {{'frmPegawaiSkHitungPayroll_kategoriPegawai'| translate | splitCharT }}
                                                    <span style="color: red;font-weight: bolder;">*</span>
                                                    <span *ngIf="!form.get('kategoriPegawai').valid && form.get('kategoriPegawai').touched" style="color: red;font-weight: bolder;">
                                                        {{'frmPegawaiSkHitungPayroll_required'| translate | splitCharT }}</span>
                                                </label>
                                                <!-- <p-multiSelect [options]="kategoriPegawai" formControlName="kategoriPegawai" [(ngModel)]="selectedKategori" multiple="multiple" checkbox="checkbox" filterBy="label" optionLabel="label">  </p-multiSelect> -->
                                                <p-dropdown formControlName="kategoriPegawai" filter="filter" [(ngModel)]="kdKategoriPegawai" (onChange)="valuechangeGetKomponen($event)" class="ui-inputwrapper-filled" filterBy="label" [options]="kategoriPegawai"
                                                [autoWidth]="false"></p-dropdown>

                                            </div>
                                        </div>
                                        <div class="ui-g-12 ui-md-3">
                                            <div class="ui-g-12 ui-md-12">
                                                <label>{{'frmPegawaiSkHitungPayroll_komponenGaji'| translate | splitCharT}}
                                                    <span style="color: red;font-weight: bolder;">*</span>
                                                    <span *ngIf="!form.get('komponenGaji').valid && form.get('komponenGaji').touched" style="color: red;font-weight: bolder;">
                                                        {{'frmPegawaiSkHitungPayroll_required'| translate | splitCharT }}</span>
                                                </label>
                                                <!-- <p-dropdown formControlName="komponenGaji" filter="filter" class="ui-inputwrapper-filled" filterBy="label" [options]="komponenGaji"
                                                    [autoWidth]="false"></p-dropdown> -->
                                                    <p-multiSelect [options]="komponenGaji" formControlName="komponenGaji" [(ngModel)]="selectedKomponenGaji" multiple="multiple"
                                                    checkbox="checkbox" filterBy="label" optionLabel="label">
                                                </p-multiSelect>

                                            </div>
                                        </div>
                                        <div class="ui-g-12 ui-md-3">           
                                            <div class="ui-g-12 ui-md-12">
                                                <label>{{'frmPegawaiSkHitungPayroll_persentase'| translate | splitCharT }}
                                                    <span style="color: red;font-weight: bolder;">*</span>
                                                    <span *ngIf="!form.get('persenHargaSatuan').valid && form.get('persenHargaSatuan').touched" style="color: red;font-weight: bolder;">
                                                        {{'frmPegawaiSkHitungPayroll_required'| translate | splitCharT }}</span>
                                                </label>
                                                <input id="input" type="number" formControlName="persenHargaSatuan" pInputText/>
                                            </div>
                                        </div>
                                    </p-fieldset>
                                </div>
                                <div class="ui-g-12">
                                    <p-fieldset legend="">
                                        <div class="ui-g form-group">
                                            <div class="ui-g-12 ui-md-3">
                                                <div class="ui-g-12 ui-md-12">
                                                    <label>{{'frmPegawaiSkHitungPayroll_periode' | translate | splitCharT }}
                                                        <span style="color: red;font-weight: bolder;">*</span>
                                                        <span *ngIf="!form.get('kdPeriodeHead').valid && form.get('kdPeriodeHead').touched" style="color: red;font-weight: bolder;">
                                                            {{'frmPegawaiSkHitungPayroll_required'| translate | splitCharT }}</span>
                                                    </label>
                                                    <p-dropdown formControlName="kdPeriodeHead" filter="filter" class="ui-inputwrapper-filled" filterBy="label" [options]="periode"
                                                    [autoWidth]="false"></p-dropdown>
                                                </div>
                                                <div class="ui-g-12 ui-md-12">
                                                    <label for="input">{{'frmPegawaiSkHitungPayroll_minimalMasaKerjauntukTHR'| translate | splitCharT }}
                                                    </label>
                                                    <input id="input" type="number" formControlName="qtyHariMinActive" pInputText/>
                                                </div>
                                                <!-- <div class="ui-g-12 ui-md-12">
                                                    <label>{{'frmPegawaiSkHitungPayroll_tanggalHariRaya'| translate | splitCharT }}
                                                    </label>
                                                    <p-dropdown formControlName="tglHariRaya" class="ui-inputwrapper-filled" [options]="tglHariRaya" [autoWidth]="false"></p-dropdown>
                                                </div> -->
                                            </div>
                                            <div class="ui-g-12 ui-md-3">

                                                <div class="ui-g-12 ui-md-12">
                                                    <label>{{'frmPegawaiSkHitungPayroll_caraBayar' | translate | splitCharT }}
                                                        <span style="color: red;font-weight: bolder;">*</span>
                                                        <span *ngIf="!form.get('caraBayar').valid && form.get('caraBayar').touched" style="color: red;font-weight: bolder;"> {{'frmPegawaiSkHitungPayroll_required'| translate | splitCharT }}</span>
                                                    </label>
                                                    <p-dropdown formControlName="caraBayar" filter="filter" class="ui-inputwrapper-filled" [options]="caraBayar" [autoWidth]="false"></p-dropdown>
                                                </div>
                                                <div class="ui-g-12 ui-md-12" hidden="true">
                                                    <label>{{'frmPegawaiSkHitungPayroll_jumlahHariTerbitSlipGaji'| translate | splitCharT }}
                                                        <span style="color: red;font-weight: bolder;">*</span>
                                                        <span *ngIf="!form.get('qtyHariSlipGiven').valid && form.get('qtyHariSlipGiven').touched" style="color: red;font-weight: bolder;">
                                                            {{'frmPegawaiSkHitungPayroll_required'| translate | splitCharT }}</span>
                                                    </label>
                                                    <input id="input" type="number" formControlName="qtyHariSlipGiven" pInputText/>
                                                </div>
                                                
                                                <div class="ui-g-12 ui-md-6">
                                                    <label for="input">{{'frmPegawaiSkHitungPayroll_proRate' | translate | splitCharT }}</label>
                                                </div>
                                                <div class="ui-g-12 ui-md-6">
                                                    <p-checkbox binary="true" label="{{'frmPegawaiSkHitungPayroll_ya'| translate | splitCharT }}" formControlName="isProRate"></p-checkbox>
                                                </div>
                                                <div class="ui-g-12 ui-md-12">
                                                    <p-checkbox binary="true" label="{{'frmPegawaiSkHitungPayroll_status'| translate | splitCharT }}" formControlName="statusAktif"></p-checkbox>
                                                    <span *ngIf="!form.get('statusAktif').valid && form.get('statusAktif').touched" style="color: red">* {{'frmPegawaiSkHitungPayroll_required'| translate | splitCharT}}.</span>
                                                </div>

                                            </div>
                                            <div class="ui-g-12 ui-md-3" hidden="true">
                                                <div class="ui-g-12 ui-md-12">
                                                    <label>{{'frmPegawaiSkHitungPayroll_tanggalBayar'| translate | splitCharT }}
                                                        <span style="color: red;font-weight: bolder;">*</span>
                                                        <span *ngIf="!form.get('tglBayar').valid && form.get('tglBayar').touched" style="color: red;font-weight: bolder;"> {{'frmPegawaiSkHitungPayroll_required'| translate | splitCharT }}</span>
                                                    </label>
                                                    <p-dropdown formControlName="tglBayar" filter="filter" class="ui-inputwrapper-filled" [options]="tglBayar" [autoWidth]="false"></p-dropdown>

                                                </div>
                                                <div class="ui-g-12 ui-md-12">
                                                    <label>{{'frmPegawaiSkHitungPayroll_tanggalBayarMax'| translate | splitCharT }}
                                                        <span style="color: red;font-weight: bolder;">*</span>
                                                        <span *ngIf="!form.get('tglBayarMax').valid && form.get('tglBayarMax').touched" style="color: red;font-weight: bolder;">
                                                            {{'frmPegawaiSkHitungPayroll_required'| translate | splitCharT }}</span>
                                                    </label>
                                                    <p-dropdown formControlName="tglBayarMax" filter="filter" class="ui-inputwrapper-filled" [options]="tglBayarMax" [autoWidth]="false"></p-dropdown>
                                                </div>
                                            </div>
                                            <!-- <div class="ui-g-12 ui-md-3">
                                                
                                                <div class="ui-g-12 ui-md-6">
                                                    <label for="input">{{'frmPegawaiSkHitungPayroll_proRate' | translate | splitCharT }}</label>
                                                </div>
                                                <div class="ui-g-12 ui-md-6">
                                                    <p-checkbox binary="true" label="{{'frmPegawaiSkHitungPayroll_ya'| translate | splitCharT }}" formControlName="isProRate"></p-checkbox>
                                                </div>
                                                <div class="ui-g-12 ui-md-12">
                                                    <p-checkbox binary="true" label="{{'frmPegawaiSkHitungPayroll_status'| translate | splitCharT }}" formControlName="statusAktif"></p-checkbox>
                                                    <span *ngIf="!form.get('statusAktif').valid && form.get('statusAktif').touched" style="color: red">* {{'required'| translate | splitCharT}}.</span>
                                                </div>
                                            </div> -->
                                        </div>
                                    </p-fieldset>
                                </div>
                            </form>

                        </div>
                        <div class="ui-g-12">
                            <form [formGroup]="form" (ngSubmit)="onSubmit()">
                                <div class="ui-g-12 ui-md-7"></div>
                                <div class="ui-g-12 ui-md-1">
                                    <button pButton type="button" label="{{'frmPegawaiSkHitungPayroll_btnBatal'| translate | splitCharT }}" icon="fa-refresh" (click)="reset()"></button>
                                </div>
                                <div class="ui-g-12 ui-md-1">
                                    <button pButton type="button" label="{{'frmPegawaiSkHitungPayroll_btnSimpan'| translate | splitCharT }}" icon="fa-save" (click)="onSubmit()"></button>
                                </div>
                                <div class="ui-g-12 ui-md-1">
                                    <button pButton type="button" label="{{'frmPegawaiSkHitungPayroll_btnHapus'| translate | splitCharT }}" icon="fa-trash" (click)="confirmDelete()"></button>
                                </div>
                                <div class="ui-g-12 ui-md-1">
                                    <button pButton type="button" label="{{'frmPegawaiSkHitungPayroll_btnCetak'| translate | splitCharT }}" icon="fa-print" (click)="cetak()"></button>
                                </div>
                                <div class="ui-g-12 ui-md-1">
                                    <p-splitButton label="{{'frmPegawaiSkHitungPayroll_btnExport'| translate | splitCharT }}" icon="fa-external-link" [model]="items"></p-splitButton>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="ui-g-12">
                        <p-dataTable [value]="listData" [rows]="10" [paginator]="true" [pageLinks]="3" [rowsPerPageOptions]="[5,10,20]" selectionMode="single"
                        [(selection)]="selected" (onRowSelect)="onRowSelect($event)" expandableRows="true" [totalRecords]="totalRecords"
                        (onLazyLoad)="loadPage($event)" [lazy]="true" scrollable="true">
                        <p-header>
                            <div class="ui-helper-clearfix">
                                <i class="fa fa-search" style="padding:0.5em 0.5em;float:right"></i>
                                <input type="text" pInputText size="50" placeholder="{{'frmPegawaiSkHitungPayroll_tablePencarian'| translate | splitCharT}}" [(ngModel)]="pencarian"
                                (keyup)="cari()" style="width: 20%;float:right;">
                                <span style="float: left;padding:0.3em;">{{'frmPegawaiSkHitungPayroll_tableTitle'| translate | splitCharT }}</span>
                            </div>
                        </p-header>
                        <!-- <p-column field="kode.noSK" header="{{'frmPegawaiSkHitungPayroll_tableNomor' | translate | splitCharT }}" [style]="{'width':'100px'}"></p-column> -->
                        <p-column field="noSKIntern" header="{{'frmPegawaiSkHitungPayroll_tableNoSKIntern' | translate | splitCharT }}" [style]="{'width':'100px'}"></p-column>
                        <p-column field="namaSK" header="{{'frmPegawaiSkHitungPayroll_tableNama' | translate | splitCharT }}" [style]="{'width':'250px'}"></p-column>
                        <p-column field="tglBerlakuAwal" header="{{'frmPegawaiSkHitungPayroll_tableTanggalBerlakuAwal' | translate | splitCharT }}" [style]="{'width':'150px'}">
                            <ng-template pTemplate="body" let-StatusSK="rowData">
                                <span *ngIf="StatusSK.tglBerlakuAwal != null">{{StatusSK.tglBerlakuAwal * 1000 | date:'dd MMM yyyy'}}</span>
                                <span *ngIf="StatusSK.tglBerlakuAwal == null">-</span>
                            </ng-template>
                        </p-column>
                        <p-column field="tglBerlakuAkhir" header="{{'frmPegawaiSkHitungPayroll_tableTanggalBerlakuAkhir' | translate | splitCharT }}" [style]="{'width':'150px'}">
                            <ng-template pTemplate="body" let-StatusSK="rowData">
                                <span *ngIf="StatusSK.tglBerlakuAkhir != null">{{StatusSK.tglBerlakuAkhir * 1000 | date:'dd MMM yyyy'}}</span>
                                <span *ngIf="StatusSK.tglBerlakuAkhir == null">-</span>
                            </ng-template>
                        </p-column>
                        <p-column field="namaKategoryPegawai" header="{{'frmPegawaiSkHitungPayroll_tableKategoriPegawai'| translate | splitCharT }}" [style]="{'width':'200px'}"></p-column>
                        <p-column field="masaKerja" header="{{'frmPegawaiSkHitungPayroll_tableMasaKerja'| translate | splitCharT }}" [style]="{'width':'250px'}"></p-column>
                        <p-column field="namaKomponenGaji" header="{{'frmPegawaiSkHitungPayroll_tableKomponenGaji'| translate | splitCharT }}" [style]="{'width':'250px'}"></p-column>
                        <p-column field="isProRate" header="{{'frmPegawaiSkHitungPayroll_tableProRate'| translate | splitCharT }}" [style]="{'width':'200px'}">
                            <ng-template pTemplate="body" let-StatusSK="rowData">
                                <span *ngIf="StatusSK.isProRate == 1">Ya</span>
                                <span *ngIf="StatusSK.isProRate == 0">Tidak</span>
                            </ng-template>
                        </p-column>
                        <p-column field="qtyHariMinActive" header="{{'frmPegawaiSkHitungPayroll_tableMinMasaKerjaUntukTHR'| translate | splitCharT }}" [style]="{'width':'200px'}"></p-column>
                            <!-- <p-column field="tanggalHariRaya" header="{{'frmPegawaiSkHitungPayroll_tableTanggalHariRaya'| translate | splitCharT }}" [style]="{'width':'200px'}">
                                <ng-template pTemplate="body" let-StatusSK="rowData">
                                    <span *ngIf="StatusSK.tanggalHariRaya != null">{{StatusSK.tanggalHariRaya * 1000 | date:'dd/MM/yyyy'}}</span>
                                    <span *ngIf="StatusSK.tanggalHariRaya == null">-</span>
                                </ng-template>
                            </p-column> -->
                            <p-column field="namaPeriode" header="{{'frmPegawaiSkHitungPayroll_tablePeriode'| translate | splitCharT }}" [style]="{'width':'250px'}"></p-column>
                            <p-column field="persenHargaSatuan" header="{{'frmPegawaiSkHitungPayroll_tablePersenHargaSatuan'| translate | splitCharT }}" [style]="{'width':'200px'}"></p-column>
                            <p-column field="namaCaraBayar" header="{{'frmPegawaiSkHitungPayroll_tableCaraBayar'| translate | splitCharT }}" [style]="{'width':'200px'}"></p-column>
                            <p-column hidden="true" field="tglBayar" header="{{'frmPegawaiSkHitungPayroll_tableTanggalBayar'| translate | splitCharT }}" [style]="{'width':'200px'}"></p-column>
                            <p-column hidden="true" field="tglBayarMax" header="{{'frmPegawaiSkHitungPayroll_tableTanggalBayarMax'| translate | splitCharT }}" [style]="{'width':'200px'}"></p-column>
                            <p-column hidden="true" field="qtyHariSlipGiven" header="{{'frmPegawaiSkHitungPayroll_tableQtyHariSlipGiven'| translate | splitCharT }}" [style]="{'width':'200px'}"></p-column>
                            <p-column field="statusEnabled" header="{{'frmPegawaiSkHitungPayroll_status'| translate | splitCharT }}" [style]="{'width':'200px'}">
                                <ng-template let-col="rowData" pTemplate type="body">
                                    {{col.statusEnabled | truefalse | translate | splitCharT }}
                                </ng-template> 
                            </p-column>
                        </p-dataTable>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>